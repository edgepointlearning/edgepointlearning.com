<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/styles.css">
  <title>Eleventy + Tailwind + Eleventy-Img Plugin</title>
  <noscript><style>noscript { display: contents; } .lazy-img { display: none; }</style></noscript>
</head>

<body class="bg-fixed bg-gradient-to-b from-pink-300 via-violet-500 to-blue-900">

  <div class="w-5/6 max-w-5xl mx-auto my-12">
    <article class="prose lg:prose-xl">
      <h1>Walden Pond</h1>
      <h2>The centerpiece of Thoreauâ€™s Walden Woods</h2>
      <p>Walden Pond is owned and managed by the Massachusetts Department of Conservation and Recreation, and sees nearly 600,000 visitors every year. An exceptionally deep and remarkably clear kettle lake, Walden still inspires the conservation ethic that Thoreau first articulated in his writings.</p>
      <p>The writer, transcendentalist, and philosopher, Henry David Thoreau, lived on the shores of Walden Pond for two years, two months, and two days, starting on the Fourth of July in 1845.</p>
    </article>
  </div>

  <div class="flex gap-6 pb-2 mx-auto mt-6 overflow-x-auto snap-x snap-mandatory">
    <div class="w-1/6 snap-align-none shrink-0"></div>
    {% for pic in pictures limit:7 %}
      <div class="w-5/6 max-w-5xl snap-always snap-center shrink-0 first:ml-6 last:mr-6">
        {% image pic.filename, pic.alt, "card object-cover aspect-video" %}
      </div>
    {% endfor %}
    <div class="w-1/6 snap-align-none shrink-0"></div>
  </div>

  {% for pic in pictures offset:7 %}
    <div class="w-5/6 max-w-5xl mx-auto my-6">
      {% image pic.filename, pic.alt, "card object-cover aspect-[9/16]" %}
    </div>
  {% endfor %}

<script>
  const lazyLoad = (targets, onIntersection) => {
    const observer = new IntersectionObserver((entries, self) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          onIntersection(entry.target);
          self.unobserve(entry.target);
        }
      });
    });
    targets.forEach((target) => observer.observe(target));
  };  

  const lazyPictures = document.querySelectorAll('.lazy-picture');
  lazyLoad(lazyPictures, (pictureElement) => {
    const img = pictureElement.querySelector('img');
    const sources = pictureElement.querySelectorAll('source');

    // Cleanup tasks after the image loads. Important to
    // define this handler before setting src/srcsets.
    img.onload = () => {
      pictureElement.dataset.loaded = true;
      img.removeAttribute('data-src');
    };
    img.onerror = () => {
      pictureElement.dataset.loaded = false;
    }

    // Swap in the media sources
    sources.forEach((source) => {
      source.sizes = source.dataset.sizes;
      source.srcset = source.dataset.srcset;
      source.removeAttribute('data-srcset');
      source.removeAttribute('data-sizes');
    });

    // Swap in the image
    img.src = img.dataset.src;
  });
</script>
</body>
</html>